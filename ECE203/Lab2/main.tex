\documentclass[12pt,letterpaper]{article}

\usepackage[margin=1.9cm]{geometry}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{pgfplots}
\usepackage{siunitx}

\usepgfplotslibrary{fillbetween}

\pgfplotsset{compat=1.16}

\begin{document}
\section*{Part 1 High Pass Filter}
\subsection*{1.}
\begin{tikzpicture}
    \begin{axis}[
        title = {Gain vs frequency},
        xlabel = $\log{f}$,
        ylabel = $\frac{V_out}{V_in}$,
        xmin = 2, 
        xmax = 5,
        ymin = 0,
        ymax = 1,
        axis lines=left,
        grid = both,
        height = 6cm,
        width = 17cm,
        legend pos=south west
    ]
    \addplot table [x=logf, y=VoutVin, col sep=comma, mark=none] {Part1.csv} ;
    \addplot [name path=passregion, mark=none, black, domain=2:5, opacity=0.5] {0.7071067812} node[above,pos=0.9] {Pass Region};
    
    \path[name path=axis] (axis cs:2,1) -- (axis cs:5,1);
    \addplot [
        thick,
        color=black,
        fill=black, 
        fill opacity=0.05
    ]
    fill between[
        of=passregion and axis,
        soft clip={domain=2:5},
    ];

\end{axis}
\end{tikzpicture}
\subsection*{2.}
    Pass region calculation:
    \begin{align*}
    \text{Half Power Voltage} &= \frac{10}{\sqrt{2}} = \SI{7.071067812}{\volt}\\
    \text{Pass Region} &= \frac{\text{Half Power Voltage}}{\SI{10}{\volt}} = 0.707
    \end{align*}
\subsection*{3.}
    Lowest frequency that passes occurs at $\log(f) \simeq 3.8$, therefore $f = \SI{e3.8}{\hertz} = \SI{6309.57}{\hertz}$
\section*{Part 2 Low Pass Filter}
\subsection*{4.}
\begin{tikzpicture}
    \begin{axis}[
        title = {Gain vs frequency},
        xlabel = $\log{f}$,
        ylabel = $\frac{V_out}{V_in}$,
        xmin = 2, 
        xmax = 5,
        ymin = 0,
        ymax = 1,
        axis lines=left,
        grid = both,
        height = 6cm,
        width = 17cm,
        legend pos=south west
    ]
    
    \addplot table [x=logf, y=VoutVin, col sep=comma, mark=none] {Part2.csv} ;
    \addplot [name path=passregion, mark=none, black, domain=2:5, opacity=0.5] {0.7071067812} node[above,pos=0.9] {Pass Region};
    
    \path[name path=axis] (axis cs:2,1) -- (axis cs:5,1);
    \addplot [
        thick,
        color=black,
        fill=black, 
        fill opacity=0.05
    ]
    fill between[
        of=passregion and axis,
        soft clip={domain=2:5},
    ];

\end{axis}
\end{tikzpicture}
\subsection*{7.}
    Pass region calculation:
    \begin{align*}
    \text{Half Power Voltage} &= \frac{2}{\sqrt{2}} = \SI{1.414213562}{\volt}\\
    \text{Pass Region} &= \frac{\text{Half Power Voltage}}{\SI{2}{\volt}} = 0.707
    \end{align*}
\subsection*{6.}
    Lowest frequency that passes occurs at $log(f) \simeq 3.75$, or $f = \SI{e3.75}{\hertz} = \SI{5623.41}{\hertz}$
\section*{Part 3 Band Pass Filter}
\subsection*{7.}
\begin{tikzpicture}
    \begin{axis}[
        title = {Gain vs frequency},
        xlabel = $\log{f}$,
        ylabel = $\frac{V_out}{V_in}$,
        xmin = 2, 
        xmax = 5,
        ymin = 0,
        ymax = 1,
        axis lines=left,
        grid = both,
        height = 6cm,
        width = 17cm,
        legend pos=south west
    ]
    
    \addplot table [x=logf, y=VoutVin, col sep=comma, mark=none] {Part3.csv} ;
    \addplot [name path=passregion, mark=none, black, domain=2:5, opacity=0.5] {0.7071067812} node[above,pos=0.9] {Pass Region};
    
    \draw (3.502836639, 0) -- (3.502836639, 1);
    
    \path[name path=axis] (axis cs:2,1) -- (axis cs:5,1);
    \addplot [
        thick,
        color=black,
        fill=black, 
        fill opacity=0.05
    ]
    fill between[
        of=passregion and axis,
        soft clip={domain=2:5},
    ];
\end{axis}
\end{tikzpicture}
\subsection*{8.}
    Lowest frequency that passes occurs at $log(f) \simeq 3.75$, or $f = \SI{e3.75}{\hertz} = \SI{5623.41}{\hertz}$
\subsection*{9.}
    The lower bound occurs at $log(f) \simeq 3.15$, or $f = \SI{e3.15}{\hertz} = \SI{1412.54}{\hertz}$. The upper bound occurs at $log(f) \simeq 3.85$, or $f = \SI{e3.85}{\hertz}= \SI{7079.46}{\hertz}$.
    
\subsection*{10}
    The resonant frequency obtained in the lab was $\SI{3183}{\hertz}$. This is in direct correlation with the value calculated in the prelab assuming ideal conditions. 
    
    The percent error calculated was:
    \begin{align}
        \frac{|3183-3183.1|}{3183.1} \times 100\% = \num[round-precision=3, round-mode = figures]{-3.14159153d-3}\%
    \end{align}

\end{document}